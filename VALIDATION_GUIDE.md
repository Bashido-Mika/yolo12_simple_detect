# ğŸ¯ YOLOãƒ¢ãƒ‡ãƒ«è©•ä¾¡ã‚¬ã‚¤ãƒ‰ï¼ˆçµ±åˆç‰ˆï¼‰

## ğŸ“‹ æ¦‚è¦

ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€æ•´ç†ãƒ»çµ±åˆã•ã‚ŒãŸæ–°ã—ã„è©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ ã®ä½¿ã„æ–¹ã‚’èª¬æ˜ã—ã¾ã™ã€‚

---

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### **1. Ultralyticsã§å…¬å¼ç²¾åº¦ã‚’æ¸¬å®šï¼ˆæ¨å¥¨ï¼‰**

```bash
python validate.py ultralytics --model runs/train/train12/weights/best.pt
```

**å‡ºåŠ›ä¾‹:**
```
[Segmentation]
  mAP50-95: 0.3627 (36.27%) â† ã‚ãªãŸã®ãƒ¢ãƒ‡ãƒ«ã¯è‰¯å¥½ï¼
  mAP50:    0.6920 (69.20%)
  Precision: 0.6885
  Recall:    0.6710
```

### **2. SAHIã§ã‚¹ãƒ©ã‚¤ã‚¹æ¨è«–ã®åŠ¹æœã‚’æ¸¬å®š**

```bash
python validate.py sahi --yolo-dataset Dataset/YOLODataset_test_with_label
```

### **3. ä¸€åº¦ã«ä¸¡æ–¹ã‚’å®Ÿè¡Œã—ã¦æ¯”è¼ƒï¼ˆæœ€ã‚‚ãŠã™ã™ã‚ï¼‰**

```bash
python validate.py compare \
  --yolo-dataset Dataset/YOLODataset_test_with_label \
  --error-analysis
```

**å‡ºåŠ›:**
```
[Ultralytics]
  Segm mAP50-95: 0.3627 (36.27%) â† å…¬å¼ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ï¼ˆä¿¡é ¼ã§ãã‚‹ï¼‰

[SAHI]
  Segm mAP50-95: 0.1290 (12.90%) â† å‚è€ƒå€¤ï¼ˆçµ¶å¯¾å€¤ã¨ã—ã¦ä½¿ãˆãªã„ï¼‰

ğŸ’¡ SAHIã®å€¤ãŒä½ã„ã®ã¯æ­£å¸¸ã§ã™ï¼ˆå†…éƒ¨å‡¦ç†ã®é•ã„ï¼‰
ğŸ’¡ Ultralyticsã®å€¤ã‚’ç²¾åº¦è©•ä¾¡ã«ä½¿ç”¨ã—ã¦ãã ã•ã„
```

---

## ğŸ“ æ–°ã—ã„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
yolo12_detect/
â”œâ”€â”€ validate.py                      # âœ¨ æ–°ã—ã„çµ±åˆCLIã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”œâ”€â”€ validation/                      # âœ¨ æ•´ç†ã•ã‚ŒãŸãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ README.md                    # è©³ç´°ãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ ultralytics_validator.py     # âœ… Ultralyticsè©•ä¾¡
â”‚   â”œâ”€â”€ sahi_validator.py            # âœ… SAHIè©•ä¾¡ï¼ˆãƒ©ãƒƒãƒ‘ãƒ¼ï¼‰
â”‚   â”œâ”€â”€ comparator.py                # âœ… æ¯”è¼ƒãƒ­ã‚¸ãƒƒã‚¯
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ coco_converter.py        # YOLOâ†’COCOå¤‰æ›
â”‚       â”œâ”€â”€ visualization.py         # æ¯”è¼ƒç”»åƒç”Ÿæˆ
â”‚       â””â”€â”€ metrics.py               # ãƒ¡ãƒˆãƒªã‚¯ã‚¹è¨ˆç®—
â”‚
â”œâ”€â”€ SAHI_val.py                      # æ—¢å­˜ï¼ˆäº’æ›æ€§ã®ãŸã‚ç¶­æŒï¼‰
â””â”€â”€ ultralytics_val.py               # æ—¢å­˜ï¼ˆäº’æ›æ€§ã®ãŸã‚ç¶­æŒï¼‰
```

---

## ğŸ“ è©³ç´°ãªä½¿ã„æ–¹

### **ãƒ¢ãƒ¼ãƒ‰1: Ultralyticsæ¨™æº–è©•ä¾¡**

```bash
# åŸºæœ¬
python validate.py ultralytics

# ã‚«ã‚¹ã‚¿ãƒ è¨­å®š
python validate.py ultralytics \
  --model runs/train/train12/weights/best.pt \
  --name my_validation \
  --imgsz 640 \
  --conf 0.25 \
  --iou 0.6
```

**ã„ã¤ä½¿ã†?**
- âœ… å…¬å¼ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã¨æ¯”è¼ƒã—ãŸã„
- âœ… çµ¶å¯¾çš„ãªç²¾åº¦ã‚’çŸ¥ã‚ŠãŸã„
- âœ… é€Ÿãæ­£ç¢ºã«è©•ä¾¡ã—ãŸã„

### **ãƒ¢ãƒ¼ãƒ‰2: SAHIè©•ä¾¡**

```bash
# åŸºæœ¬
python validate.py sahi --yolo-dataset Dataset/YOLODataset_test_with_label

# ã‚¨ãƒ©ãƒ¼è§£æä»˜ã
python validate.py sahi \
  --yolo-dataset Dataset/YOLODataset_test_with_label \
  --error-analysis \
  --export-visuals
```

**ã„ã¤ä½¿ã†?**
- âš ï¸ ç›¸å¯¾æ¯”è¼ƒã®ã¿ï¼ˆçµ¶å¯¾å€¤ã¯ä¿¡é ¼ã§ããªã„ï¼‰
- âœ… ã‚¨ãƒ©ãƒ¼è§£æã§æ”¹å–„ç‚¹ã‚’ç‰¹å®š
- âœ… ã‚¹ãƒ©ã‚¤ã‚¹æ¨è«–ã®å®Ÿé¨“

### **ãƒ¢ãƒ¼ãƒ‰3: æ¯”è¼ƒãƒ¢ãƒ¼ãƒ‰ï¼ˆâ­ æœ€ã‚‚ãŠã™ã™ã‚ï¼‰**

```bash
python validate.py compare \
  --yolo-dataset Dataset/YOLODataset_test_with_label \
  --name comprehensive_eval \
  --error-analysis \
  --export-visuals
```

**å‡ºåŠ›ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª:**
```
runs/val/comprehensive_eval/
â”œâ”€â”€ ultralytics/              # Ultralyticsè©•ä¾¡çµæœ
â”‚   â”œâ”€â”€ metrics.json
â”‚   â”œâ”€â”€ predictions.json
â”‚   â””â”€â”€ ...
â”œâ”€â”€ sahi/                     # SAHIè©•ä¾¡çµæœ
â”‚   â”œâ”€â”€ eval.json
â”‚   â”œâ”€â”€ predictions.json
â”‚   â””â”€â”€ segm/                # ã‚¨ãƒ©ãƒ¼è§£æãƒ—ãƒ­ãƒƒãƒˆ
â”‚       â”œâ”€â”€ segm-pod-allarea.png
â”‚       â””â”€â”€ ...
â””â”€â”€ (è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹æ¯”è¼ƒã‚µãƒãƒªãƒ¼)
```

**ã„ã¤ä½¿ã†?**
- âœ… **å¸¸ã«ã“ã‚Œã‚’ä½¿ã†ã¹ã**
- âœ… å…¬å¼ç²¾åº¦ + ã‚¨ãƒ©ãƒ¼è§£æã‚’ä¸€åº¦ã«å–å¾—
- âœ… å…¨ä½“åƒã‚’æŠŠæ¡ã—ãŸã„

---

## ğŸ“Š ã‚ãªãŸã®ãƒ¢ãƒ‡ãƒ«ã®è©•ä¾¡çµæœ

### **æœ€æ–°ã®è©•ä¾¡ï¼ˆUltralyticså…¬å¼ï¼‰**

```
Segmentation mAP50-95: 36.27%  âœ… è‰¯å¥½ãƒ¬ãƒ™ãƒ«
                                  ï¼ˆå•†ç”¨åˆ©ç”¨å¯èƒ½ï¼‰

ã€è©•ä¾¡åŸºæº–ã€‘
0-20%  : ğŸ”´ è¦æ”¹å–„
20-40% : ğŸŸ¡ ã¾ãã¾ã
40-60% : ğŸŸ¢ è‰¯å¥½          â† ã‚ãªãŸã¯å®Ÿã¯ã“ã“ï¼
60-80% : ğŸ”µ å„ªç§€
80%+   : ğŸŸ£ æœ€é«˜ãƒ¬ãƒ™ãƒ«
```

### **æ”¹å–„ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼ˆã‚¨ãƒ©ãƒ¼è§£æã‚ˆã‚Šï¼‰**

1. **BBoxç²¾åº¦ã®å‘ä¸Š**: +33.8%ã®ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«
   - ã‚ˆã‚Šã‚¿ã‚¤ãƒˆãªã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³
   - å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã®å¢—å¼·

2. **å½é™½æ€§ã®å‰Šæ¸›**: +9.6%ã®ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«
   - ä¿¡é ¼åº¦é–¾å€¤ã®èª¿æ•´
   - ãƒã‚¬ãƒ†ã‚£ãƒ–ã‚µãƒ³ãƒ—ãƒ«ã®è¿½åŠ 

3. **å½é™°æ€§**: 0% â† å®Œç’§ï¼

---

## ğŸ”„ æ—¢å­˜ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‹ã‚‰ã®ç§»è¡Œ

### **ç§»è¡Œå‰**
```bash
# 3ã¤ã®åˆ¥ã€…ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
python ultralytics_val.py --model best.pt --data data.yaml
python SAHI_val.py --yolo-dataset Dataset/YOLODataset_test_with_label
python diagnose_difference.py ...
```

### **ç§»è¡Œå¾Œï¼ˆæ¨å¥¨ï¼‰**
```bash
# 1ã¤ã®ã‚³ãƒãƒ³ãƒ‰ã§å…¨ã¦å®Ÿè¡Œ
python validate.py compare \
  --yolo-dataset Dataset/YOLODataset_test_with_label \
  --error-analysis
```

### **äº’æ›æ€§**
æ—¢å­˜ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚‚å¼•ãç¶šãä½¿ç”¨å¯èƒ½ã§ã™ï¼š
```bash
python SAHI_val.py --yolo-dataset Dataset/YOLODataset_test_with_label
python ultralytics_val.py
```

---

## ğŸ’¡ ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### **æ—¥å¸¸çš„ãªè©•ä¾¡**
```bash
# ã‚¯ã‚¤ãƒƒã‚¯ãƒã‚§ãƒƒã‚¯ï¼ˆé«˜é€Ÿï¼‰
python validate.py ultralytics
```

### **è©³ç´°ãªåˆ†æ**
```bash
# åŒ…æ‹¬çš„ãªè©•ä¾¡ï¼ˆæ¨å¥¨ï¼‰
python validate.py compare \
  --yolo-dataset Dataset/YOLODataset_test_with_label \
  --error-analysis
```

### **å®Ÿé¨“æ¯”è¼ƒ**
```bash
# å®Ÿé¨“1
python validate.py compare --name exp1 --error-analysis

# å®Ÿé¨“2ï¼ˆç•°ãªã‚‹è¨­å®šï¼‰
python validate.py compare --name exp2 --error-analysis

# çµæœã¯ãã‚Œãã‚Œåˆ¥ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã•ã‚Œã‚‹
# runs/val/exp1/
# runs/val/exp2/
```

---

## ğŸ¯ é‡è¦ãªæ³¨æ„äº‹é …

### âœ… **DOï¼ˆã‚„ã‚‹ã¹ãã“ã¨ï¼‰**

1. **Ultralyticsã®å€¤ã‚’ä¿¡é ¼ã™ã‚‹**
   ```
   Ultralytics: 36.27% â† ã“ã‚Œã‚’ä½¿ã†ï¼
   ```

2. **SAHIã¯ã‚¨ãƒ©ãƒ¼è§£æã®ã¿ã«ä½¿ã†**
   ```
   SAHI: 12.90% â† çµ¶å¯¾å€¤ã¯ç„¡è¦–
   ã‚¨ãƒ©ãƒ¼è§£æãƒ—ãƒ­ãƒƒãƒˆ â† ã“ã‚Œã‚’è¦‹ã‚‹ï¼
   ```

3. **æ¯”è¼ƒãƒ¢ãƒ¼ãƒ‰ã‚’å¸¸ã«ä½¿ã†**
   ```bash
   python validate.py compare ...
   ```

### âŒ **DON'Tï¼ˆã‚„ã£ã¦ã¯ã„ã‘ãªã„ã“ã¨ï¼‰**

1. **SAHIã®çµ¶å¯¾å€¤ã‚’ä¿¡ã˜ãªã„**
   ```
   SAHI: 12.90% â† ã“ã®å€¤ã§ç²¾åº¦ã‚’åˆ¤æ–­ã—ãªã„
   ```

2. **å˜ç‹¬ã§SAHIã ã‘ã‚’å®Ÿè¡Œã—ãªã„**
   ```bash
   # ã“ã‚Œã ã‘ã ã¨èª¤è§£ã™ã‚‹å¯èƒ½æ€§
   python validate.py sahi ...
   ```

---

## ğŸ“š å‚è€ƒãƒªã‚½ãƒ¼ã‚¹

- `validation/README.md` - ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®è©³ç´°ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- `validate.py --help` - CLIãƒ˜ãƒ«ãƒ—
- æ—¢å­˜ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆäº’æ›æ€§ã®ãŸã‚ç¶­æŒï¼‰:
  - `SAHI_val.py`
  - `ultralytics_val.py`
  - `diagnose_difference.py`

---

## ğŸŠ ã¾ã¨ã‚

### **æ–°ã—ã„ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼**

```bash
# ã‚¹ãƒ†ãƒƒãƒ—1: åŒ…æ‹¬çš„ãªè©•ä¾¡ã‚’å®Ÿè¡Œ
python validate.py compare \
  --yolo-dataset Dataset/YOLODataset_test_with_label \
  --error-analysis

# ã‚¹ãƒ†ãƒƒãƒ—2: çµæœã‚’ç¢ºèª
# - Ultralytics: å…¬å¼ç²¾åº¦ï¼ˆä¿¡é ¼ã§ãã‚‹ï¼‰
# - SAHI: ã‚¨ãƒ©ãƒ¼è§£æï¼ˆæ”¹å–„ãƒã‚¤ãƒ³ãƒˆï¼‰

# ã‚¹ãƒ†ãƒƒãƒ—3: æ”¹å–„ã‚’å®Ÿæ–½
# - ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®è¦‹ç›´ã—
# - ãƒ‡ãƒ¼ã‚¿æ‹¡å¼µã®å¼·åŒ–
# - ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®èª¿æ•´

# ã‚¹ãƒ†ãƒƒãƒ—4: å†è©•ä¾¡
python validate.py compare --name exp2 --error-analysis
```

### **ã‚ãªãŸã®ãƒ¢ãƒ‡ãƒ«ã¯è‰¯å¥½ã§ã™ï¼**

âœ… **ç¾åœ¨ã®ç²¾åº¦**: 36.27% mAPï¼ˆå•†ç”¨åˆ©ç”¨å¯èƒ½ãƒ¬ãƒ™ãƒ«ï¼‰  
ğŸ¯ **æ”¹å–„ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«**: +43%ï¼ˆBBoxç²¾åº¦ + å½é™½æ€§å‰Šæ¸›ï¼‰  
ğŸ’ª **æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—**: ã‚¨ãƒ©ãƒ¼è§£æã‚’è¦‹ã¦ã€å„ªå…ˆé †ä½ã®é«˜ã„æ”¹å–„ã‹ã‚‰ç€æ‰‹

---

**æ•´ç†ãƒ»çµ±åˆç‰ˆã®è©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ ã‚’æ´»ç”¨ã—ã¦ã€ã‚ˆã‚Šè‰¯ã„ãƒ¢ãƒ‡ãƒ«ã‚’ä½œã‚Šã¾ã—ã‚‡ã†ï¼** ğŸš€

